clc
clear all
close all

x = [0
1.98459E-16
5.98298E-16
1.20243E-15
2.01375E-15
3.03516E-15
4.26952E-15
5.71969E-15
7.38852E-15
9.27884E-15
1.13935E-14
1.37352E-14
1.63067E-14
1.91109E-14
2.21505E-14
2.54281E-14
2.89464E-14
3.27082E-14
3.67162E-14
4.09728E-14
4.54809E-14
5.02429E-14
5.52615E-14
6.05392E-14
3.124888893
6.752606127
10.93813097
15.73966426
21.21862418
27.43963215
34.47048865
42.38213848
51.24862534
61.14703536
72.15742925
84.36276278
97.84879538
112.7039866
129.0193803
146.8884761
166.4070887
187.6731941
210.7867638
235.8495858
262.9650746
292.2380679
323.7746129
357.681741
394.0672322
433.0393705
474.7066893
519.17771
566.560673
616.9632639
670.4923342
727.2536196
787.3514564
850.8884978
917.965431
988.6806974
1063.130218
1141.407122
1223.601488
1309.80009
1400.086152
1494.539125
1593.234463
1696.243426
1803.632892
1915.465188
2031.797937
2152.68393
2278.171005
2408.301958
2543.114468
2682.64104
2826.908973
2975.940346
3129.752021
3288.355667
3451.757804
3619.959863
3792.958259
3970.744489
4153.305238
4340.622498
4532.673704
4729.43188
4930.865796
5136.940128
5347.615639
5562.84935
5782.594732
6006.80189
6235.417761
6468.386305
6705.648705
6947.143558
7192.80708
7442.573291
7696.374216
7954.140072
8215.799457
8481.279529
8750.506194
9023.404272
9299.897675
9579.909568
9863.36253
10150.17871
10440.27998
10733.58807
11030.02472
11329.5118
11631.97146
11937.3262
12245.49908
12556.41374
12869.99456
13186.16676
13504.85647
13825.99087
14149.49824
14475.30808
14803.35115
15133.5596
15465.86702
15800.20851
16136.52075
16474.74209
16814.81258
17156.67405
17500.2702
17845.54659
18192.45076
18540.93223
18890.94261
19242.4356
19595.36706
19949.69507
20305.37996
20662.38434
21020.67319
21380.21386
21740.97616
22102.93234
22466.05719
22830.32805
23195.72487
23562.23024
23929.82943
24298.51044
24668.26405
25039.08384
25410.96624
25783.91061
26157.91921
26532.99731
26909.15323
27286.39834
27664.74716
28044.21737
28424.8299
28806.60895
29189.58205
29573.78013
29959.23756
30345.99222
30734.08555
31123.56264
31514.47225
31906.86695
32300.80309
32696.34098
33093.5449
33492.48321
33893.22841
34295.85725
34700.45082
35107.09463
35515.87873
35926.8978
36340.25127
36756.04341
37174.3835
37595.3859
38019.17022
38445.86144
38875.59004
39308.49221
39744.70995
40184.39124
40627.69026
41074.76753
41525.79014
41980.93191
42440.37366
42904.30338
43372.9165
43846.41615
44325.0134
44808.92753
45298.38636
45793.62656
46294.89392
46802.44377
47316.54131
47837.46198
48365.49195
48900.92844
49444.0803
49995.26843
50554.82631
51131.17748
51709.78178
52278.29787
52836.74489
53385.14245
53923.51055
54451.86969
54970.24075
55478.64508
55977.10446
56465.64109
56944.27762
57413.03711
57871.94306
58321.01938
58760.29044
59189.78098
59609.51621
60019.52173
60419.82356
60810.44813
61191.42231
61562.77335
61924.52893
62276.71711
62619.36638
62952.50562
63276.16413
63590.37159
63895.15807
64190.55406
64476.59044
64753.29845
65020.70976
65278.8564
65527.77081
65767.48579
65998.03454
66219.45063
66431.76801
66635.02103
66829.24437
67014.47313
67190.74274
67358.08905
67516.54823
67666.15685
67806.95182
67938.97044
68062.25036
68176.82959
68282.7465
68380.03982
68468.74864
68548.91239
68620.57087
68683.76424
68738.53299
68784.91797
68822.96038
68852.70177
68874.18403
68887.4494
68892.54046
68889.50015
68878.37173
68859.19882
68832.02536
68796.89565
68753.85432
68702.94635
68644.21703
68577.71201
68503.47728
68421.55915
68332.00427
68234.85963
68130.17255
68017.99067
67898.362
67771.33484
67636.95785
67495.28002
67346.35067
67190.21944
67026.93631
66856.55161
66679.11597
66494.68038
66303.29615
66105.01492
65899.88866
65687.96969
65469.31065
65243.96451
65011.98459
64773.42454
64528.33833
64276.78028
64018.80504
63754.46762
63483.82333
63206.92785
62923.83718
62634.60768
62339.29605
62037.95931
61730.65484
61417.44038
61098.37399
60773.51411
60442.91949
60106.64927
59764.76291
59417.32026
59064.3815
58706.00716
58342.25817
57973.19578
57598.88163
57219.37771
56834.74639
56445.0504
56050.35285
55650.71723
55246.20739
54836.88757
54422.82241
54004.07689
53580.71643
53152.8068
52720.41419
52283.60517
51842.44672
51397.00621
50947.35143
50493.55058
50035.67226
49573.78549
49107.95972
48638.2648
48164.77104
47687.54916
47206.67031
46722.20609
46234.22855
45742.81016
45248.02388
44749.94309
44248.64164
43744.19387
43236.67455
42726.15895
42212.72282
41696.44239
41177.39436
40655.65595
40131.30487
39604.41934
39075.07809
38543.36036
38009.34591
37473.11505
36934.74859
36394.32791
35851.93492
35307.6521
34761.56246
34213.74959
33664.29768
33113.29145
32560.81624
32006.95798
31451.80319
30895.439
30337.95317
29779.43406
29219.97068
28659.65266
28098.57031
27536.81457
26974.47704
26411.65001
25848.42643
25284.89997
24721.16496
24157.31648
23593.4503
23029.66292
22466.05158
21902.71428
21339.74975
20777.25751
20215.33784
19654.09183
19093.62135
18534.02909
17975.41856
17417.89409
16861.56087
16306.52494
15752.89322
15200.77348
14650.27443
14101.50563
13554.57761
13009.6018
12466.69059
11925.95732
11387.51632
10851.48288
10317.97332
9787.104969
9258.996174
8733.766344
8211.535947
7692.426529
7176.560732
6664.062309
6155.056142
5649.668259
5148.025851
4650.25729
4156.492147
3666.861211
3181.496507
2700.531318
2224.100202
1752.33901
1285.384913
823.3764173
366.4533867
-85.24293412
-531.5698984
-972.3834351
-1407.538025
-1836.886679
-2260.280911
-2677.570716
-3088.604546
-3493.22928
-3891.290203
-4282.630976
-4667.093612
-5044.518445
-5414.744102
-5777.607477
-6132.943701
-6480.586106
-6820.366203
-7152.113643
-7475.65619
-7790.819686
-8097.428016
-8395.303074
-8684.264732
-8964.130799
-9234.716984
-9495.836862
-9747.301835
-9988.921089
-10220.50156
-10441.84787
-10652.76234
-10853.04488
-11042.49298
-11220.90166
-11388.06342
-11543.76822
-11687.80336
-11819.95352
-11940.00064
-12047.72389
-12142.89963
-12225.30135];

y = [6400
6403.241082
6409.770963
6419.637203
6432.887189
6449.56811
6469.726941
6493.410422
6520.665045
6551.537035
6586.072344
6624.316633
6666.31527
6712.11332
6761.755544
6815.286397
6872.750028
6934.190292
6999.650747
7069.174673
7142.805084
7220.584741
7302.556176
7388.761713
7479.189433
7573.925724
7673.010253
7776.48223
7884.380396
7996.743022
8113.607906
8235.01236
8360.993212
8491.586795
8626.828945
8766.754992
8911.399754
9060.797528
9214.982085
9373.986656
9537.843926
9706.586023
9880.244502
10058.85034
10242.43391
10431.02497
10624.65267
10823.34549
11027.13127
11236.03714
11450.08954
11669.3142
11893.73608
12123.37937
12358.2675
12598.42303
12843.86772
13094.62244
13350.70717
13612.14098
13878.94199
14151.12735
14428.7132
14711.71469
15000.14591
15294.01988
15593.34853
15898.14269
16208.41204
16524.16513
16845.40934
17172.15083
17504.39461
17842.14443
18185.40286
18534.17118
18888.44948
19248.23656
19613.52999
19984.32607
20360.61983
20742.40507
21129.67432
21522.41886
21920.62872
22324.29272
22733.39843
23147.93223
23567.8793
23993.22361
24423.94802
24860.0342
25301.46272
25748.21305
26200.26357
26657.59164
27120.17356
27587.98467
28060.99932
28539.19094
29022.53206
29510.99434
30004.54862
30503.16491
31006.8125
31515.45993
32029.07508
32547.62516
33071.0768
33599.39606
34132.54847
34670.4991
35213.21256
35760.6531
36312.78458
36869.5706
37430.97447
37996.95929
38567.48801
39142.52343
39722.02828
40305.96526
40894.29708
41486.98651
42083.99642
42685.28982
43290.82994
43900.58022
44514.5044
45132.56654
45754.73108
46380.96288
47011.22724
47645.48999
48283.7175
48925.87672
49571.93526
50221.86137
50875.62406
51533.19307
52194.53894
52859.63308
53528.44776
54200.95617
54877.13249
55556.95189
56240.39058
56927.42586
57618.03615
58312.20104
59009.90132
59711.11902
60415.83746
61124.04128
61835.71647
62550.85043
63269.432
63991.45151
64716.90081
65445.77331
66178.06403
66913.76962
67652.88847
68395.42065
69141.36804
69890.73435
70643.52515
71399.74792
72159.41214
72922.52927
73689.11287
74459.17859
75232.7443
76009.83005
76790.45822
77574.65351
78362.44304
79153.85642
79948.92577
80747.68583
81550.17402
82356.43051
83166.4983
83980.4233
84798.25439
85620.04356
86445.84594
87275.71994
88109.72732
88947.93331
89790.40669
90637.21997
91488.4494
92344.17521
93204.48165
94069.45717
94939.19457
95813.7911
96693.34869
97577.97407
98467.77893
99362.88016
100263.4
101169.4663
102081.2126
102998.7786
103922.3102
104851.9597
105787.8864
106730.2565
107679.2438
108635.0297
109597.8036
110576.2418
111549.6485
112518.0257
113481.3757
114439.7007
115393.0029
116341.2845
117284.5477
118222.7948
119156.0282
120084.2501
121007.4628
121925.6688
122838.8705
123747.0703
124650.2706
125548.4738
126441.6826
127329.8995
128213.127
129091.3677
129964.6243
130832.8994
131696.1958
132554.5161
133407.8632
134256.2397
135099.6487
135938.0929
136771.5753
137600.0988
138423.6664
139242.2811
140055.946
140864.6642
141668.4389
142467.2731
143261.1703
144050.1335
144834.1663
145613.2718
146387.4535
147156.7149
147921.0595
148680.4907
149435.0122
150184.6276
150929.3407
151669.1551
152404.0745
153134.103
153859.2442
154579.5023
155294.881
156005.3846
156711.0171
157411.7826
158107.6853
158798.7296
159484.9197
160166.2599
160842.7548
161514.4088
162181.2265
162843.2124
163500.3713
164152.7079
164800.227
165442.9333
166080.832
166713.9278
167342.226
167965.7316
168584.4498
169198.3858
169807.545
170411.9328
171011.5546
171606.4159
172196.5225
172781.8798
173362.4937
173938.3701
174509.5148
175075.9337
175637.633
176194.6188
176746.8972
177294.4747
177837.3574
178375.5519
178909.0648
179437.9026
179962.072
180481.5798
180996.4329
181506.6383
182012.2029
182513.1339
183009.4386
183501.1243
183988.1982
184470.6681
184948.5413
185421.8257
185890.529
186354.6591
186814.2239
187269.2316
187719.6903
188165.6082
188606.9938
189043.8555
189476.202
189904.0418
190327.3838
190746.2369
191160.6102
191570.5126
191975.9535
192376.9422
192773.4882
193165.601
193553.2903
193936.566
194315.4379
194689.916
195060.0106
195425.732
195787.0905
196144.0966
196496.7611
196845.0948
197189.1084
197528.8132
197864.2202
198195.3407
198522.1863
198844.7685
199163.099
199477.1896
199787.0525
200092.6996
200394.1433
200691.3961
200984.4704
201273.379
201558.1349
201838.7509
202115.2403
202387.6165
202655.8928
202920.083
203180.2008
203436.2603
203688.2755
203936.2608
204180.2306
204420.1995
204656.1824
204888.1942
205116.25
205340.3653
205560.5555
205776.8362
205989.2235
206197.7332
206402.3817
206603.1854
206800.1609
206993.325
207182.6947
207368.2872
207550.1201
207728.2107
207902.577
208073.237
208240.209
208403.5113
208563.1626
208719.1818
208871.5879
209020.4004
209165.6388
209307.3227
209445.4722
209580.1076
209711.2493
209838.918
209963.1347
210083.9205
210201.2969
210315.2856
210425.9085
210533.1878
210637.146
210737.8058
210835.1902
210929.3224
211020.226
211107.9248
211192.4429
211273.8045
211352.0345
211427.1577
211499.1994
211568.1852
211634.1408
211697.0924
211757.0664
211814.0897
211868.1894
211919.3928
211967.7276
212013.222
212055.9044
212095.8035
212132.9484
212167.3685
212199.0936
212228.1539
212254.5799
212278.4024
212299.6528
212318.3626
212334.5639
212348.2892
212359.5711
212368.4429
212374.9382
212379.091
212380.9358
212380.5075
212377.8413
212372.973
212365.9387
212356.775
212345.5192
212332.2086
212316.8813
212299.5758
212280.3311
212259.1867
212236.1824
212211.3588
212184.7569
212156.4182
212126.3846
212094.6989
212061.4041
212026.5439
211990.1625
211952.3048
211913.0162
211872.3426
211830.3307
211787.0277
211742.4815
211696.7404
211649.8537
211601.871
211552.8428
211502.8203
211451.8552
211400
211347.308
211293.833
211239.6298
211184.7537
211129.2611
211073.2088
211016.6545
210959.657
210902.2756
210844.5704];

myVideo = VideoWriter('myVideoFile'); %open video file
myVideo.FrameRate = 10;  %can adjust this, 5 - 10 works well for me
open(myVideo)

t = 0:.1:2*pi;
r_earth = 6400;

x_earth = r_earth*cos(t);
y_earth = r_earth*sin(t);

plot(x_earth,y_earth);  hold on;
area(x_earth,y_earth);
 grid on;

 data = 0:1:487;
 n = numel(data);

 for i = 1:n

plot(x(1:i),y(1:i),'DisplayName','Initial Takeoff');
  xlim([-8.5e5 8.5e5]);
   ylim([-8.5e5 8.5e5]);
  drawnow;

  title('Flight Profile from Takeoff to SSO');
  xlabel('Distance from Center of Earth (m)');
  ylabel('Distance from Center of Earth (m)');

      pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);
  
 end 

 t2 = 0:.01:2*pi;
 n2 = numel(t2);

 for j = 1:n2

r_park = 6400+205000;

x_sun = r_park*cos(t2+(pi/2));
y_sun = r_park*sin(t2+(pi/2));

plot(x_sun(1:j),y_sun(1:j),'DisplayName','Parking Orbit');
% text(0,-221400,'\uparrow Perigee Kick');
% text(0,737400,'\downarrow Apogee Kick');
drawnow;

    pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);
 end

 t5 = 0:.01:pi;
 n5 = numel(t5);

for p = 1:n5

r_park = 6400+205000;

x_sun = r_park*cos(t5+(pi/2));
y_sun = r_park*sin(t5+(pi/2));

plot(x_sun(1:p),y_sun(1:p),'Color','black','LineWidth',1);
% text(0,-221400,'\uparrow Perigee Kick');
% text(0,737400,'\downarrow Apogee Kick');
drawnow;

    pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);
 end

t3 = -pi/2:.01:pi/2;
n3 = numel(t3);

for z = 1:n3

a_trans = (741000+6400) - r_park;
b_trans = (r_park+(741000+6400))/2;
h = 0;
k = 268000;


x_trans = h + a_trans*cos(t3);
y_trans = k + b_trans*sin(t3);

plot(x_trans(1:z),y_trans(1:z),'DisplayName','Hohmann Transfer Orbit','Color','black')
 drawnow;
    pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);

end

t4 = 0:.01:2*pi;
n4 = numel(t4);

for q = 1:n4

r_SSO = 741000+6400;
x_SSO = r_SSO*cos(t4+(pi/2));
y_SSO = r_SSO*sin(t4+(pi/2));

plot(x_SSO(1:q),y_SSO(1:q),'DisplayName','Sun Synchronous Orbit')

drawnow;

    pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);
end

for l = 1:n4

r_SSO = 741000+6400;
x_SSO = r_SSO*cos(t4+(pi/2));
y_SSO = r_SSO*sin(t4+(pi/2));

plot(x_SSO(1:l),y_SSO(1:l),'Color','black','LineWidth',1)

drawnow;
    pause(0.1) %Pause and grab frame
    frame = getframe(gcf); %get frame
    writeVideo(myVideo, frame);
end


hold off;
close(myVideo)
e = sqrt(1-((b_trans^2)/(a_trans^2)));